const XLSX = require('xlsx');

// Template data with proper column names matching the latest "Tambah Siswa & Wali" form
// Email Wali has been removed as it is now auto-generated by the system
const templateData = [
  {
    'Nama Siswa': 'Abdullah Rahman',
    'NISN': '0012345678',
    'NIS': '24001',
    'Jenis Kelamin': 'L',
    'Tanggal Lahir': '2010-05-15',
    'Diterima di Kelas / Angkatan': 'X',
    'Kelas Saat Ini': 'X',
    'Tahun Ajaran Masuk': '2024/2025',
    'Alamat': 'Jl. Masjid No. 123, Jakarta',
    'Nomor WhatsApp Siswa': '081234567890',
    'Jenis Wali': 'Ayah',
    'Nama Wali': 'Ahmad Rahman',
    'Jenis Kelamin Wali': 'L',
    'No HP Wali': '081234567891'
  },
  {
    'Nama Siswa': 'Fatimah Azzahra',
    'NISN': '0012345679',
    'NIS': '24002',
    'Jenis Kelamin': 'P',
    'Tanggal Lahir': '2010-08-22',
    'Diterima di Kelas / Angkatan': 'X',
    'Kelas Saat Ini': 'X',
    'Tahun Ajaran Masuk': '2024/2025',
    'Alamat': 'Jl. Pesantren No. 45, Bogor',
    'Nomor WhatsApp Siswa': '',
    'Jenis Wali': 'Ibu',
    'Nama Wali': 'Siti Aminah',
    'Jenis Kelamin Wali': 'P',
    'No HP Wali': '082345678901'
  }
];

// Create workbook
const wb = XLSX.utils.book_new();

// Create worksheet from template data
const ws = XLSX.utils.json_to_sheet(templateData);

// Set column widths for better readability
ws['!cols'] = [
  { wch: 25 }, // Nama Siswa
  { wch: 15 }, // NISN
  { wch: 12 }, // NIS
  { wch: 15 }, // Jenis Kelamin
  { wch: 15 }, // Tanggal Lahir
  { wch: 25 }, // Diterima di Kelas / Angkatan
  { wch: 15 }, // Kelas Saat Ini
  { wch: 20 }, // Tahun Ajaran Masuk
  { wch: 35 }, // Alamat
  { wch: 20 }, // Nomor WhatsApp Siswa
  { wch: 15 }, // Jenis Wali
  { wch: 25 }, // Nama Wali
  { wch: 18 }, // Jenis Kelamin Wali
  { wch: 15 }  // No HP Wali
];

XLSX.utils.book_append_sheet(wb, ws, 'Template Import Siswa');

// Generate file
const filename = 'Template_Import_Siswa_Wali_Terbaru.xlsx';
XLSX.writeFile(wb, filename);

console.log(`âœ… Template created: ${filename}`);
